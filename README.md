# Malware Detection

Detect whether a Windows PE file is malicious or not using MalConv network.

## Requirement

```
torch==1.7.1
numpy==1.19.4
matplotlib==3.3.3
scikit_learn==0.24.0
lightgbm==3.1.1
lief==0.10.1
```

## How To Prepare Data

```
|-- data
    |-- benign
    |-- malcious
|-- train.py
|-- predict.py
|-- ...
```

Put benign PE file dataset under `data/benign` folder.

Put  malicious PE file dataset under `data/malicious` folder.

## How To Train

`python train.py`

Optinal arguments:

`--device` default: "cuda:0"

`--max_len` maximum length of byte sequence fed into MalConv default: 1024 * 1024

`--window_size` this argument equals to kernel size and stride default: 512

`--batch_size` defalut: 64

`--num_epochs` default: 20

`--lr` initial learning rate default: 0.01

`--interval` log interval between batches default: 50

`--resume` resume from `results/models/model.pth`

Models are saved to `results/models` folder.

Loss and accuracy curves are saved to `results/images` folder.

## How To Predict

`python predict.py --file_path="file/path"`

Path to a PE file must be provided.

## Reference

>Anderson H S, Roth P. Ember: an open dataset for training static pe malware machine learning models[J]. arXiv preprint arXiv:1804.04637, 2018.

>Raff E, Barker J, Sylvester J, et al. Malware detection by eating a whole exe[J]. arXiv preprint arXiv:1710.09435, 2017.